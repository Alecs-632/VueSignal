import{d as $,a as h,w as E,o as U,T as F,W as A,M as j,c as k,b as V,e as v,f as O,v as T,g as I,h as G,i as P,j as z,s as J,k as W,l as q,m as H,n as K,u as Q,p as X,P as Y}from"./vendor-BohjmEtK.js";import{h as M,f as Z,k as B,l as R,I as S,F as L,m as ee,V as te}from"./oxyplot-js-CNQjqazg.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&p(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function oe(){const a=[];return function(f,n){if(typeof n!="object"||n===null)return n;for(;a.length>0&&a[a.length-1]!==this;)a.pop();return a.includes(n)?"[Circular]":(a.push(n),n)}}function ne(a,f){let n=a;return a instanceof Error&&(n={name:a.name,message:a.message,stack:a.stack}),JSON.stringify(n,oe(),f)}const se={class:"w-[800px]"},ae={id:"plotViewWrapper",style:{resize:"both",overflow:"auto",width:"800px",height:"600px"},class:"border border-gray-200 rounded-lg shadow p-4"},re={id:"pdfPlotView",class:"w-full h-full"},le={id:"canvasPlotView",class:"w-full h-full"},ie={id:"svgPlotView",class:"w-full h-full"},ce={class:"flex justify-between mt-2"},ue={class:"flex items-center"},de={key:0,class:"flex"},fe={key:0,class:"flex items-center"},me={key:1,class:"flex items-center ml-2"},pe={key:1,class:"flex"},ve=$({__name:"PlotViewer",props:{exampleInfo:{}},emits:["optionsChanged"],setup(a,{emit:f}){const n=a,p=f,o=h(!1),i=h(!1),d=h(!1),w=h(!1),r=h("canvas"),C=h(["canvas","pdf","svg"]),t=h("landscape");E([o,d,r,t],()=>{c(),p("optionsChanged",{isTransposed:o.value,isReversed:d.value,renderType:r})}),E(()=>n.exampleInfo,()=>{c()}),U(()=>{c()});async function c(){if(!n.exampleInfo)return;console.log("props.exampleInfo:",n.exampleInfo);const s=n.exampleInfo,e=await s.example.model();if(!e)return;i.value=M.isTransposable(e),w.value=M.isReversible(e),o.value&&(i.value?M.transpose(e):o.value=!1),d.value&&(w.value?M.reverseAllAxes(e):d.value=!1);const u=y();u.model=e,s.example.controller?u.controller=s.example.controller():u.controller=void 0;const b=e.toJSON({excludeDefault:!0});console.log(ne(b))}function m(){return document.getElementById("canvasPlotView")}let l={};function y(){if(r.value==="canvas"){const s="canvas";if(l[s])return l[s];const e=m(),u=new F(e);return l[s]=u,u}if(r.value==="pdf"){const s=t.value;if(l[s])return l[s];const e=new A(document.getElementById("pdfPlotView"));return e.orientation=t.value,l[s]=e,e}if(r.value==="svg"){const s="svg";let e=l[s];const u=document.getElementById("svgPlotView");return u.innerHTML="",e||(e=new j(u),l[s]=e,e)}throw new Error(`Unknown renderer type: ${r.value}`)}async function g(){if(!n.exampleInfo)return;const e=await n.exampleInfo.example.model();if(!e)return;await new H({orientation:t.value}).download(e,e.title||n.exampleInfo.title)}return(s,e)=>{const u=J,b=K,x=W,N=q;return V(),k("div",se,[v("div",ae,[O(v("iframe",re,null,512),[[T,r.value==="pdf"]]),O(v("canvas",le,null,512),[[T,r.value==="canvas"]]),O(v("div",ie,null,512),[[T,r.value==="svg"]])]),v("div",ce,[v("div",ue,[e[4]||(e[4]=G(" Средство визуализации: ")),P(u,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=_=>r.value=_),options:C.value,class:"ml-2 text-sm"},null,8,["modelValue","options"]),r.value==="pdf"?(V(),z(b,{key:0,modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=_=>t.value=_),options:["пейзаж","портрет"],class:"ml-4"},null,8,["modelValue"])):I("",!0)]),r.value==="canvas"||r.value==="svg"?(V(),k("div",de,[s.exampleInfo?(V(),k("div",fe,[P(x,{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=_=>o.value=_),binary:!0,disabled:!i.value,inputId:"chkTransposed"},null,8,["modelValue","disabled"]),e[5]||(e[5]=v("label",{class:"ml-1 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",for:"chkTransposed"},"Транспонированный",-1))])):I("",!0),s.exampleInfo?(V(),k("div",me,[P(x,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=_=>d.value=_),binary:!0,disabled:!w.value,inputId:"chkReversed"},null,8,["modelValue","disabled"]),e[6]||(e[6]=v("label",{class:"ml-1 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",for:"chkReversed"},"Перевернутый",-1))])):I("",!0)])):I("",!0),r.value==="pdf"?(V(),k("div",pe,[P(N,{size:"small",severity:"info",icon:"pi pi-download",onClick:g,label:"Скачать"})])):I("",!0)])])}}}),he=(a,f)=>{const n=a.__vccOpts||a;for(const[p,o]of f)n[p]=o;return n},we=he(ve,[["__scopeId","data-v-1f0f4ef3"]]),ye={class:"flex-grow ml-4"},ge=$({__name:"App",setup(a){var f=h(null);U(async()=>{var t=await p();f.value={example:{model:async()=>t},title:"Датчик"}});function n(){return new URLSearchParams(window.location.search).get("file")}async function p(){var t=new Z({title:"Датчик",subtitle:"Ток в мА"});t.axes.push(new B({position:L.Left,majorGridlineStyle:S.None,maximumPadding:0,minorGridlineStyle:S.None,tickStyle:R.Inside,title:"Ток (мА)"})),t.axes.push(new B({position:L.Bottom,majorGridlineStyle:S.None,maximumPadding:0,minorGridlineStyle:S.None,tickStyle:R.Inside,title:"Время (с)"}));const c=await o(n());return c.color=i(),t.series.push(c),t}const o=async t=>{const c=new ee;try{if(!t)throw new Error("Имя файла не указано.");const m=await fetch(`/${t}`);if(!m.ok)throw new Error("Ответ сети был неудовлетворительным.");const l=await m.json(),y=l["Частота дискретизации"],g=l["Коэффициент преобразования"],s=Math.max(...l["Массив отсчетов"]),e=Math.min(...l["Массив отсчетов"]),u=(s+e)/2,b=l["Массив отсчетов"].map((x,N)=>({x:N/y,y:(x-u)*g}));return c.points.push(...b.map(x=>te(x.x,x.y))),c}catch(m){return console.error("Ошибка при получении данных JSON:",m),c}};function i(){const t=Math.floor(Math.random()*360),c=Math.floor(Math.random()*35+65),m=Math.floor(Math.random()*50+50);return C(t,c,m)}const d=t=>t<255?t>0?t:0:255,w=t=>t>.0031308?t**(1/2.4)*269.025-14.025:t*3294.6,r=t=>t>.2068965?t**3:(t-4/29)*(108/841);function C(t,c,m){const l=r(m=(m+16)/116),y=r(m+c/500*Math.cos(t*=Math.PI/180)),g=r(m-c/200*Math.sin(t)),s=Math.floor(d(w(y*3.021973625-l*1.617392459-g*.404875592))),e=Math.floor(d(w(y*-.943766287+l*1.916279586+g*.027607165))),u=Math.floor(d(w(y*.069407491-l*.22898585+g*1.159737864)));return`#${(s.toString(16)+e.toString(16)+u.toString(16)).padStart(6,"0")}`}return(t,c)=>(V(),k("div",ye,[P(we,{"example-info":Q(f)},null,8,["example-info"])]))}}),D=X(ge);D.use(Y);D.mount("#app");
